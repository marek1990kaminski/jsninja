!function(){"use strict";function e(e,t,n){console.trace();var o=e.firstChild||document.createElement("p");o.textContent=t,e.appendChild(o),n&&(o.className=n)}function t(e){e.style.display="none"}function n(e){e.style.display="block"}function o(e,t,n){void 0===t&&(t=e,e=1);var o=Math.floor((t-e+1)*Math.random())+e;return"function"==typeof n&&(o=n(o)),o}function s(o){this.questions=o.questions,this.phrase=o.question,this.score=0,e(r,this.score),this.time=20,e(h,this.time),this.interval=window.setInterval(this.countDown.bind(this),1e3),t(a),n(u),n(h),c.innerHTML="",n(c),u.addEventListener("click",this,!1),this.chooseQuestion()}var i=document.getElementById("question"),r=document.getElementById("score"),c=document.getElementById("feedback"),a=document.getElementById("start"),u=document.getElementById("answer"),h=document.getElementById("timer"),l=0;t(u),t(h),s.prototype.chooseQuestion=function(){console.log("chooseQuestion() invoked");var e=this.questions.filter(function(e){return!1===e.asked});this.question=e[o(e.length)-1],this.ask(this.question)},s.prototype.ask=function(t){function n(){var e=s.questions[o(s.questions.length)-1];return e===t||-1!==c.indexOf(e.answer)?n():e}console.log("ask() invoked");var s=this;t.asked=!0,e(i,this.phrase+t.question+"?"),u.innerHTML="";var r,c=[],a=n();c.push(a.answer);var h=n();c.push(h.answer),c.splice(o(0,2),0,t.answer),c.forEach(function(e){(r=document.createElement("button")).value=e,r.textContent=e,u.appendChild(r)})},s.prototype.check=function(t){console.log("check() invoked"),t===this.question.answer?(e(c,"Correct!","right"),this.score++,e(r,this.score)):e(c,"Wrong!","wrong"),++l===this.questions.length?this.gameOver():this.chooseQuestion()},s.prototype.countDown=function(){this.time--,e(h,this.time),this.time<=0&&this.gameOver()},s.prototype.onClickFireCheck=function(e){this.check(e.target.value)},s.prototype.handleEvent=function(e){"click"===e.type&&this.check(e.target.value)},s.prototype.gameOver=function(){console.log("gameOver() invoked"),e(i,"Game Over, you scored "+this.score+" points"),t(u),t(h),n(a),window.clearInterval(this.interval),l=0,this.questions.forEach(function(e){e.asked=!1}),u.removeEventListener("click",this,!1)},a.addEventListener("click",function(){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState&&200===t.status){var e=JSON.parse(t.responseText);console.log("response type: "+t.responseType),console.log("response "+t.response),new s(e)}},t.open("GET","https://s3.amazonaws.com/sitepoint-book-content/jsninja/quiz.json",!0),t.overrideMimeType("application/json"),t.send(),e(i,"Waiting for questions...")},!1),e(r,0),u.addEventListener("submit",function(e){e.preventDefault()},!1)}();