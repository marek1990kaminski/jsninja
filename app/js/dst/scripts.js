!function(){"use strict";function e(e,t,o){console.trace();var n=e.firstChild||document.createElement("p");n.textContent=t,e.appendChild(n),o&&(n.className=o)}function t(e){e.style.display="none"}function o(e){e.style.display="block"}function n(e,t,o){void 0===t&&(t=e,e=1);var n=Math.floor((t-e+1)*Math.random())+e;return"function"==typeof o&&(n=o(n)),n}function s(n){this.questions=n.questions,this.phrase=n.question,this.score=0,e(r,this.score),this.time=20,e(u,this.time),this.interval=window.setInterval(this.countDown.bind(this),1e3),t(a),o(h),o(u),c.innerHTML="",o(c),h.addEventListener("click",this,!1),this.chooseQuestion()}var i=document.getElementById("question"),r=document.getElementById("score"),c=document.getElementById("feedback"),a=document.getElementById("start"),h=document.getElementById("answer"),u=document.getElementById("timer"),l=document.getElementById("hiScore"),d=0;t(h),t(u),s.prototype.hiScore=function(){if(window.localStorage){var e=localStorage.getItem("hiScore")||0;return(this.score>e||0===e)&&(this.score>e&&window.alert("ey b0ss, you just beaten the high score with your "+this.score+" scores!"),localStorage.setItem("hiScore",this.score)),localStorage.getItem("hiScore")}},s.prototype.chooseQuestion=function(){console.log("chooseQuestion() invoked");var e=this.questions.filter(function(e){return!1===e.asked});this.question=e[n(e.length)-1],this.ask(this.question)},s.prototype.ask=function(t){function o(){var e=s.questions[n(s.questions.length)-1];return e===t||-1!==c.indexOf(e.answer)?o():e}console.log("ask() invoked");var s=this;t.asked=!0,e(i,this.phrase+t.question+"?"),h.innerHTML="";var r,c=[],a=o();c.push(a.answer);var u=o();c.push(u.answer),c.splice(n(0,2),0,t.answer),c.forEach(function(e){(r=document.createElement("button")).value=e,r.textContent=e,h.appendChild(r)})},s.prototype.check=function(t){console.log("check() invoked"),t===this.question.answer?(e(c,"Correct!","right"),this.score++,e(r,this.score)):e(c,"Wrong!","wrong"),++d===this.questions.length?this.gameOver():this.chooseQuestion()},s.prototype.countDown=function(){this.time--,e(u,this.time),this.time<=0&&this.gameOver()},s.prototype.onClickFireCheck=function(e){this.check(e.target.value)},s.prototype.handleEvent=function(e){"click"===e.type&&this.check(e.target.value)},s.prototype.gameOver=function(){console.log("gameOver() invoked"),e(i,"Game Over, you scored "+this.score+" points"),t(h),t(u),o(a),window.clearInterval(this.interval),d=0,this.questions.forEach(function(e){e.asked=!1}),h.removeEventListener("click",this,!1),l.innerText="for now the higest score = "+this.hiScore()},a.addEventListener("click",function(){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState&&200===t.status){var e=JSON.parse(t.responseText);console.log("response type: "+t.responseType),console.log("response "+t.response),new s(e)}},t.open("GET","https://s3.amazonaws.com/sitepoint-book-content/jsninja/quiz.json",!0),t.overrideMimeType("application/json"),t.send(),e(i,"Waiting for questions...")},!1),e(r,0),h.addEventListener("submit",function(e){e.preventDefault()},!1)}();