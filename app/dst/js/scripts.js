!function(){"use strict";function e(e,t,o){void 0===t&&(t=e,e=1);var n=Math.floor((t-e+1)*Math.random())+e;return"function"==typeof o&&(n=o(n)),n}function t(e){this.questions=e.questions,this.phrase=e.question,this.score=0,o.update(o.score,this.score),this.time=20,o.update(o.timer,this.time),this.interval=window.setInterval(this.countDown.bind(this),1e3),o.hide(o.start),o.show(o.form),o.show(o.timer),o.feedback.innerHTML="",o.show(o.feedback),o.form.addEventListener("click",this,!1),this.chooseQuestion()}var o=function(){return{question:document.getElementById("question"),score:document.getElementById("score"),feedback:document.getElementById("feedback"),start:document.getElementById("start"),form:document.getElementById("answer"),timer:document.getElementById("timer"),hiscore:document.getElementById("hiScore"),update:function(e,t,o){void 0;var n=e.firstChild||document.createElement("p");n.textContent=t,e.appendChild(n),o&&(n.className=o)},hide:function(e){e.style.display="none"},show:function(e){e.style.display="block"}}}(),n=0;o.hide(o.form),o.hide(o.timer),t.prototype.hiScore=function(){if(window.localStorage){var e=localStorage.getItem("hiScore")||0;return(this.score>e||0===e)&&(this.score>e&&void 0,localStorage.setItem("hiScore",this.score)),localStorage.getItem("hiScore")}},t.prototype.chooseQuestion=function(){void 0;var t=this.questions.filter(function(e){return!1===e.asked});this.question=t[e(t.length)-1],this.ask(this.question)},t.prototype.ask=function(t){function n(){var o=s.questions[e(s.questions.length)-1];return o===t||-1!==r.indexOf(o.answer)?n():o}void 0;var s=this;t.asked=!0,o.update(o.question,this.phrase+t.question+"?"),o.form.innerHTML="";var i,r=[],c=n();r.push(c.answer);var a=n();r.push(a.answer),r.splice(e(0,2),0,t.answer),r.forEach(function(e){(i=document.createElement("button")).value=e,i.textContent=e,o.form.appendChild(i)})},t.prototype.check=function(e){void 0,e===this.question.answer?(o.update(o.feedback,"Correct!","right"),this.score++,o.update(o.score,this.score)):o.update(o.feedback,"Wrong!","wrong"),++n===this.questions.length?this.gameOver():this.chooseQuestion()},t.prototype.countDown=function(){this.time--,o.update(o.timer,this.time),this.time<=0&&this.gameOver()},t.prototype.onClickFireCheck=function(e){this.check(e.target.value)},t.prototype.handleEvent=function(e){"click"===e.type&&this.check(e.target.value)},t.prototype.gameOver=function(){void 0,o.update(o.question,"Game Over, you scored "+this.score+" points"),o.hide(o.form),o.hide(o.timer),o.show(o.start),window.clearInterval(this.interval),n=0,this.questions.forEach(function(e){e.asked=!1}),o.form.removeEventListener("click",this,!1),o.hiscore.innerText="for now the higest score = "+this.hiScore()},o.start.addEventListener("click",function(){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===e.readyState&&200===e.status){var o=JSON.parse(e.responseText);void 0,void 0,new t(o)}},e.open("GET","https://s3.amazonaws.com/sitepoint-book-content/jsninja/quiz.json",!0),e.overrideMimeType("application/json"),e.send(),o.update(o.question,"Waiting for questions...")},!1),o.update(o.score,0),o.form.addEventListener("submit",function(e){e.preventDefault()},!1)}();